---
title: "Regression Models : Course project"
author: "Yalungu Lobanga Héritier"
date: "5/23/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Executive Summary
In this report, we are going to examine the mtcars dataset and explore how miles per gallon (MPG) is affected by different variables in that dataset. We are going to  answer the following questions : Is an automatic or manual transmission better for MPG ?,Quantify the MPG difference between automatic and manual transmissions.

We are going to use the mtcars dataset, documented at the following link: https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/mtcars.html

Our analysis demonstrates the following:

Manual transmission will yield better miles per gallon, when compared with Automatic. On average, a manual car will achieve 24 mpg, versus 17 mpg for automatics.
Further analysis shows a correlation between MPG and the following confounding variables:
wt (Weight). The greater the weight of the car, the less MPG
cyl (number of engine cylinders).

## Exploratory Analysis
Loading packages 
``` {r}
library(ggplot2)
library(knitr)
library(kableExtra)
```

Loading the dataset 
```{r}
data(mtcars)
mtcars$vs <- factor(mtcars$vs)
mtcars$am.label <- factor(mtcars$am, labels=c("Automatic","Manual")) # 0=automatic, 1=manual
mtcars$gear <- factor(mtcars$gear)
mtcars$carb <- factor(mtcars$carb)
head(mtcars)
str(mtcars)
```

Exploring relationship between transmission type and miles per gallon
```{r}
boxplot(mpg ~ am.label, data = mtcars, col = (c("grey","grey50")), ylab = "Miles Per Gallon", xlab = "Transmission Type")
```
The boxplot shows that Manual Transmission provides better MPG than automatic transmission.
## Regression analysis

We can also calculate mean MPG values for cars with Automatic and Manual transmission as follows:
```{r}
aggregate(mtcars$mpg,by=list(mtcars$am.label),FUN=mean)
```

We can see again that Manual transmission yields on average 7 MPG more than Automatic, Let’s now test this hypothesis with a Simple Linear Regression Test:
```{r}
T_simple <- lm(mpg ~ factor(am), data=mtcars)
summary(T_simple)
```
The p-value is  0.000285, so we will not reject the hypothesis. However, the R-squared value for this test is only ~= .35, suggesting that only a third or so of variance in MPG can be attributed to transmission type alone. Let’s perform an Analysis of Variance for the data:
```{r}
T_variance_analysis <- aov(mpg ~ ., data = mtcars)
summary(T_variance_analysis)
```
From the above Analysis of Variance, looking for p-values of less than 0.5, gives us cyl, disp, and wt to consider in addition to transmission type (am)
```{r}
T_multivar <- lm(mpg ~ cyl + disp + wt + am, data = mtcars)
summary(T_multivar)
```
The Multivariable linear Regression test  gives us an R-squared value of 0.8327, suggesting that 83,3% of variance can be explained by the multivariable model. P-values for cyl (number of cylinders) and weight are below 0.5, suggesting that these are confounding variables in the relation between car Transmission Type and Miles per Gallon.

## Residual Plot and Analysis
```{r}
par(mfrow = c(2, 2))
plot(T_multivar)
```

The “Residuals vs Fitted” plot here shows us that the residuals are homoscedastic. We can also see that they are normally distributed, with the exception of a few outliers